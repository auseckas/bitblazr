{ kernel:  [
    // Block attempts to bind to sockets that are not on port 80 or 443
    {
        class: 'socket',
        event: 'listen',
        rules: {
            port: [{neq: 80}, {neq: 443 }]
        },
        action: 'allow'
    },
    {
        class: 'file',
        event: 'exec',
        rules: {
            path: [{starts_with: "/usr/bin"}]
        },
        action: 'allow'
    },
    {
        class: 'file',
        event: 'exec',
        rules: {
            path: [{starts_with: "/usr/sbin"}]
        },
        action: 'allow'
    },
    {
        class: 'file',
        event: 'exec',
        rules: {
            path: [{not: {starts_with: "/usr/bin"}}]
        },
        action: 'allow'
    },
    {
        class: 'file',
        event: 'open',
        context: ["container"],
        rules: {
            path: [{starts_with: "/etc/passwd"}]
        },
        action: 'block'
    },
    {
        class: 'file',
        event: 'exec',
        rules: {
            path: [{ends_with: "sed"}]
        },
        action: 'block'
    },
    {
        class: 'socket',
        event: 'connect',
        rules: {
            ip_version: [{eq: 4}],
            ip_type: [{neq: 'private'}],
            port: [{neq: 80}, {neq: 443 }]
        },
        action: 'allow'
    }
],
userspace:  [
    {
        class: 'socket',
        event: 'listen',
        rules: {},
        action: 'log'
    }
]}